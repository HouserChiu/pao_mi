# coding:utf-8
'''
鞋包店铺
'''
import os
import time
from mongo_info import mongo_info_wd
import requests
import json
import urllib3

def get_headers():
    headers = {
        'charset': 'utf-8',
        'Accept-Encoding': 'gzip',
        'referer': 'https://servicewechat.com/wx0c595cd2186d8bc5/10/page-frame.html',
        'client': 'XCX',
        'content-type': 'application/x-www-form-urlencoded',
        'User-Agent': 'Mozilla/5.0 (Linux; Android 7.1.1; 1605-A01 Build/NMF26F; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/59.0.3071.82 Mobile Safari/537.36 MicroMessenger/7.0.10.1580(0x27000A32) Process/appbrand3 NetType/WIFI Language/zh_CN ABI/arm64',
        'Host': '129010.ixiaochengxu.cc',
        'Connection': 'Keep-Alive',
    }
    return headers

def get_id():
    # id_lists = []
    # for i in range(1, 53):
    #     url = 'https://129010.ixiaochengxu.cc/index.php?s=/addon/DgStore/Api/getStoreList.html&page_index={}&ws_lat=30.651608&ws_lng=104.080275&store_cate=8140&keywords=&utoken=17fd4c76c297a40c9570c8f1302ddbe0&token=gh_f1ed514327ce'.format(i)
    #     urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
    #     res = json.loads(requests.get(url, headers=get_headers(), verify=False).text)
    #     id_list = []
    #     for temp in res['data']:
    #         id_list.append(temp['id'])
    #     id_lists.append(id_list)
    #     time.sleep(2)
    id_lists = [['43189', '264235', '22144', '53032', '55908', '41294', '43243', '282631'], ['46644', '25015', '69727', '76851', '75529', '65504', '292552', '26437'], ['44208', '277755', '291444', '291668', '53144', '257843', '70133', '264622'], ['78509', '79135', '36671', '269734', '64612', '293600', '277629', '54140'], ['82037', '75253', '36613', '283539', '26090', '48872', '257201', '33466'], ['36536', '79208', '301676', '66547', '70276', '284263', '277441', '56679'], ['77888', '77868', '291516', '300388', '269418', '285144', '25558', '68717'], ['265917', '294078', '297672', '294074', '295003', '23818', '247763', '293701'], ['68885', '314244', '293412', '293639', '33118', '247207', '75111', '28208'], ['68559', '270720', '80037', '266881', '279251', '49568', '275264', '70887'], ['267060', '75563', '293708', '267157', '301438', '39394', '276861', '33386'], ['279565', '302205', '257715', '51113', '31245', '294310', '25488', '257791'], ['296841', '283657', '240477', '72446', '294698', '51043', '270643', '297638'], ['75676', '292468', '24787', '50176', '42073', '25687', '298439', '298440'], ['292471', '296551', '64913', '50462', '281740', '23394', '29271', '48171'], ['74846', '79183', '77002', '39177', '302421', '47739', '55866', '62604'], ['68969', '43771', '69603', '82021', '73798', '291135', '285261', '48037'], ['248193', '285449', '73905', '264967', '69680', '59392', '72673', '298652'], ['49559', '279338', '35599', '42567', '286883', '300144', '55870', '275767'], ['275192', '257729', '23636', '269987', '68654', '296338', '281043', '130095'], ['68033', '247771', '289285', '25946', '266498', '82449', '28808', '78054'], ['68426', '276352', '57072', '59871', '72004', '87461', '302532', '295315'], ['293417', '288519', '75017', '294163', '75587', '36252', '303541', '291617'], ['65627', '67995', '70377', '292314', '301409', '293261', '257208', '59663'], ['34010', '283119', '282935', '287649', '279264', '21842', '70729', '264251'], ['63066', '48993', '295369', '68740', '43554', '243123', '263450', '286507'], ['266583', '282063', '58489', '300644', '268687', '64456', '75457', '247423'], ['39174', '78851', '246898', '72775', '76657', '279018', '293758', '43626'], ['67506', '299751', '293513', '299998', '284287', '48012', '24599', '257431'], ['47676', '303497', '54792', '79940', '53386', '55327', '46091', '71078'], ['79166', '77566', '46311', '270917', '68338', '282982', '65814', '40437'], ['300494', '51944', '293653', '64357', '32882', '64695', '46407', '39498'], ['300220', '269838', '284323', '43951', '268684', '82359', '77362', '55856'], ['295895', '285485', '37420', '72445', '286702', '270704', '45032', '290790'], ['65868', '62349', '62352', '62353', '293524', '294453', '39644', '36586'], ['47215', '33394', '76914', '298332', '66513', '71332', '69701', '72769'], ['69357', '286043', '66452', '68859', '70396', '75816', '300402', '77125'], ['77631', '24407', '68003', '247581', '22229', '47668', '74140', '47734'], ['71898', '57426', '62040', '268691', '35864', '56623', '72090', '82750'], ['48888', '36224', '80034', '325191', '248175', '293409', '58218', '58582'], ['272762', '295042', '75064', '75062', '283513', '71399', '55047', '68890'], ['25281', '302671', '54212', '23327', '35984', '56081', '34516', '82589'], ['75611', '29737', '68084', '80337', '17884', '55927', '76142', '72800'], ['67858', '263155', '295269', '76908', '77242', '285609', '51185', '278137'], ['74502', '33081', '81124', '76872', '28359', '42515', '70400', '279483'], ['270986', '293662', '23106', '265306', '48043', '80765', '285440', '50658'], ['65792', '28623', '291683', '57683', '56945', '297232', '297233', '43399'], ['68993', '277217', '39339', '24462', '29025', '79250', '70930', '292609'], ['314251', '266236', '79023', '43514', '292608', '282842', '68696', '68939'], ['21624', '24671', '78930', '82697', '293486', '57391', '269360', '17963'], ['23972', '298698', '293782', '271454', '265983', '79329', '32467', '282317'], ['285304', '71719', '30959']]

    # print(id_lists)
    return id_lists
# get_id()
def get_detail():
    idss = get_id()
    for ids in idss:
        for id in ids:
            url = 'https://129010.ixiaochengxu.cc/index.php?s=/addon/DgStore/StoreApi/getStoreHomeInfo.html&store_id={}&versions=2&utoken=17fd4c76c297a40c9570c8f1302ddbe0&token=gh_f1ed514327ce'.format(id)
            urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
            res = json.loads(requests.get(url, headers=get_headers(), verify=False).text)
            user_info = {}
            user_info['网红昵称'] = res['data']['store_name']
            user_info['市'] = res['data']['store_quyu']
            user_info['id'] = id
            user_info['头像'] = res['data']['store_logo']
            user_info['签名'] = res['data']['store_jieshao']
            user_info['联系电话'] = res['data']['store_con_mobile']
            user_info['第三方ID'] = 'wd_' + user_info['id']
            print(user_info)
            # try:
            #     if os.path.isfile('%s' % user_info['第三方ID'] + '.jpg'):
            #         pass
            #     else:
            #         with open('%s' % user_info['第三方ID'] + '.jpg', 'wb') as f:
            #             urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
            #             img = requests.get(user_info['头像'], verify=False).content
            #             f.write(img)
            # except requests.exceptions.MissingSchema:
            #     pass
            #
            # mongo_info_wd.insert_item(user_info)
            # time.sleep(2)

get_detail()





